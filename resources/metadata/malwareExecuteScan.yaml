metadata:
  name: malwareExecuteScan
  description: Performs a malware scan
  longDescription: |
    Performs a malware scan
spec:
  inputs:
    secrets:
    - name: malwareScanCredentialsId
      description: The technical user/password credential used to communicate with the malwarescanning service
      type: jenkins
    params:
      - name: host
        type: string
        description: "malware scanning host."
        scope:
        - PARAMETERS
        - STAGES
        - STEPS
        mandatory: true
      - name: username
        type: string
        description: "User"
        scope:
        - PARAMETERS
        - STAGES
        - STEPS
        mandatory: true
        secret: true
      - name: password
        type: string
        description: "Password"
        scope:
        - PARAMETERS
        - STAGES
        - STEPS
        mandatory: true
        secret: true
      - name: file
        type: string
        description: "The file which is scanned for malware"
        scope:
        - PARAMETERS
        - STAGES
        - STEPS
        mandatory: true
      - name: timeout
        type: string
        description: "timeout for http layer in seconds"
        scope:
        - PARAMETERS
        - STAGES
        - STEPS
        mandatory: false
        default: 600
